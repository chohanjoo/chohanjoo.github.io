---
layout: post
title:  "컨테이너의 개념"
date:   2019-05-02 15:46:59
author: Hanjoo Cho
categories: Cloud
tags:    Cloud Container
cover:  "/assets/instacode.png"
---
# 컨테이너란?

## Virutal Machines(가상머신)이란?

VM들은 '하이퍼바이저'를 통해 물리적 기계 위에서 돌아간다.

하이퍼바이저는 호스트 머신이나 베어 메탈(bare metal : 소프트웨어가 전혀 담겨있지 않은 하드웨어) 위에서 실행된다.

%% 하이퍼바이저

> VM이 실행되는 소프트웨어나 펌웨어, 혹은 하드웨어를 뜻한다. 
>
> 하이퍼바이저들은 호스트 머신이라 불리는 물리적 기계 위에서 돌아가고, 호스트 머신은 VM에 램과 CPU 등의 자원을 제공한다.

호스트 머신 위에서 하이퍼바이저를 이용하여 돌아가는 VM을 보통 게스트 머신( guest machine )이라고 부른다. 

게스트 머신은 애플리케이션을 실행하기 위한 모든 것( 시스템 바이러니, 라이브러리 …), 애플리케이션을 포함, 가상화된 네트워크 어댑터, 저장소, CPU 등의 모든 하드웨어 스택도 포함한다.

​	-> 자신 안에 또 하나의 온전한 guest 운영체제를 가지고 있는 것

**하이퍼바이저는 VM들이 각자 자신의 가상 운영체제, 즉 게스트 운영체제를 실행하고 관리할 수 있게끔 돕는 중요한 역할과 더불어, 호스트 머신들이 자원들을 VM들에게 분배할 수 있도록 도와주는 일을 한다.** 

## 컨테이너란?

> **애플리케이션** 과 **애플리케이션을 구동하는 환경**을 격리하는 공간
>
> 유저 공간( user space )의 추상화를 통해 운영체제 레벨의 가상화를 제공한다.

애플리케이션을 실행하는 컨테이너는 필수 라이브러리, 종속 요소와 파일을 사용하므로 문제없이 원활하게 애플리케이션을 프로덕션으로 진행할 수 있다. 

컨테이너도 VM처럼 프로세싱을 위한 별도의 공간(private space), 루트 권한, 사설 네트워크, IP 주소, 파일 시스템 마운트 등의 기능을 갖추고 있다.

**컨테이너는 호스트 시스템의 커널을 다른 컨테이너들과 공유한다는 점에서 차이점이 있다. 운영체제 단계의 아키텍처를 모든 컨테이너가 공유하고 있다. 처음부터 새로 생성된느 부분은 bins와 libs 뿐이며, 이것이 컨테이너가 한결 가벼워질 수 있는 이유이다.**



## 왜 컨테이너를 써야 하는가?

### - 대부분의 서버 장비들은 컴퓨팅 환경을 소프트웨어로 구현한 가상머신(VM)을 사용 

### But 다수의 운영체제를 동시에 실행하기 위해 하이퍼바이저가 필요

### & 그 상위계층에 Guest OS가 각각 설치된 가상머신들을 구동 



### - 컨테이너로 구성된 서버는 하이퍼바이저를 사용하지 않고 ,CPU, RAM, Disk, Network과 같은 운영체제의 자원을 필요한 만큼 격리하여 컨테이너에 할당



=> 가상 머신은 하드웨어 스택을 가상화한다. 컨테이너는 이와 달리 운영체제 수준에서 가상화를 실시하여 다수의 컨테이너를 OS커널에서 직접 구동한다. 컨테이너는 훨씬 가볍고 운영체제 커널을 공유하며, 시작이 훨씬 빠르고 운영체제 전체 부팅보다 메모리를 훨씬 적게 차지한다.

![vm_and_container](/assets/image/vm_and_container.png)



![va_and_container2](/assets/image/va_and_container2.png)

## 컨테이너의 장점

1. 효율성이 높다.

   기업에서는 애플리케이션 서비스를 안정적으로 운영하기 위해, 1개의 가상머신에 1개의 서비스를 구동하는 것을 권장

   하지만, 해당 애플리케이션이 가상머신의 모든 자원을 사용하지 않으므로 유후 자원이 생김 -> 성능적 오버헤드

   **컨테이너의 경우, 운영체제의 자원을 공유하기 때문에 애플리케이션을 실행한느데 필요한 만큼의 자원만 할당 받을 수 있음**

2. 신속성이 높다

3. 라이센스 비용이 절감된다.



## 컨테이너의 응용

1. 개발 환경 이전 솔루션

   컨테이너를 사용하면 환경 이전이 쉽기 때문에 드는 시간을 대폴 줄일 수 있다.

   컨테이너에 애플리케이션과 애플리케이션을 구동하는 환경을 그대로 담고 그 환경 자체를 다른 서버로 이전하면, 장애 없이 신속하고 안정적으로 환경을 이전 할 수 있다.

2. 마이크로 서비스화 솔루션

   거대한 애플리케이션을 기능별로 나누어 변경과 조합이 가능하게 한 것을 마이크로 서비스(Micro Service) 라고 한다.

   컨테이너는 기본적으로 독립적인 구조이기 때문에 하나의 변경 사항이 분리된 다른 기능들에게 영향을 미치지 않는다.

   

---

## 쿠버네티스란?

> 컨테이너들의 관리와 운영이 어려워져서 오히려 운영상의 효율성이 떨어지게 된다. 이 문제를 해결해주는 도구가 쿠버네티스(Kubernetes)이다. 쿠버네티스는 컨테이너 오케스트레이션 플랫폼 중 하나로, 구글이 자사 서비스를 위해 개발했던 Borg에서 얻은 운영 노하우를 오픈소스로 공개한 것이다.
>
> 시스템 및 서비스 관리를 대행하는 자동 컨테이너 관리 기능을 제공한다.
>
> Kubernetes를 사용하면 애플리케이션의 배포 및 관리와 관련된 모든 자겁이 한층 간편해진다.



### ? 컨테이너 오케스트레이션

여러개의 컨테이너를 편리하게 관리해주는 작업

- 스케줄링 : 컨테이너를 비교적 가장 여유로운 노드에 자동 배치

  ​				작업 노드가 죽으면 실행 중이던 컨테이너를 다른 노드에 옮겨주는 역할 수행

- 클러스터링 : 여러개의 노드를 묶어 하나처럼 사용할 수 있다.

  ​					즉 모든 컨테이너가 내부통신을 할 수 있다.

- 서비스 디스커버리 : 컨테이너가 자동으로 배치되기 때문에 어디에 배치되었는지 찾는 임수 수행

- 로깅 및 모니터링 : 로그를 관리하고 직접 또는 다른 툴을 사용해 보여줄 수 있다.



---

참고

https://developer.ibm.com/kr/cloud/2019/02/01/easy_container_kubernetes/

https://cloud.google.com/containers/?authuser=0&hl=ko

https://www.redhat.com/ko/topics/containers/whats-a-linux-container

https://medium.com/@jwyeom63/시작하는-이들을-위한-컨테이너-vm-그리고-도커에-대한-이야기-3a04c000cb5c
